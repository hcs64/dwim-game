<!doctype html>
<html>
<head>
<title>dwim</title>

<script src="utils.js"></script>
<script src="graphics.js"></script>
<script src="dwim.js"></script>

<style>
body {
  background-color: black;
}

div.status {
  font-family: monospace;
  color: white;
}

span.error {
  color: red;
}

span.att {
  color: yellow;
}

a {
  color: blue;
}

</style>
</head>

<body>
<div class="status" id="status1">Not running</div>
<div class="status" id="status2"></div>
<canvas width="640" height="480" id="level"></canvas>

<script>

levels = {
// b, testing
b: {
  startpos: {x: 0, y: 5},
  exitpos: {x: 9, y: 9},
  dims: {w: 10, h: 10},
  programs: [
    {code: 'ccdcc',
     loc: '3-5,5 5-6,4'}
  ],
  obstacles: [
    '2-7,0-3 3-6,4-6 2-7,7-9'
  ],
  available_mappings: [ ],
},
// a, testing
a: {
  dims: {w: 10, h: 8},
  startpos: {x: 0, y: 0},
  exitpos: {x: 0, y: 5},
  programs: [
    {code: 'ccddsddccc',
     loc: '3-5,0 5,1-2 4,2-4 5-6,4'},
    {code: 'hdsssss',
     loc: '7,5-7 3-6,6'},
  ],
  obstacles: [
    '0-5,2 5-6,5-6 3-6,0-8'
  ],
  available_mappings: [],
  next_level: '0',
},
// c, testing
c: {
  dims: {w: 10, h: 10},
  startpos: {x: 0, y: 0},
  exitpos: {x: 0, y: 5},
  programs: [{code: 'cc', loc: '1,1'}],
  obstacles: [],
  available_mappings: ['1-to-1'],
  next_level: 'c',
},
// 0, intro?
'0': {
  dims: {w: 10, h: 10},
  startpos: {x: 0, y:0},
  exitpos: {x:5, y:5},
  programs: [
    {code: 'cccc', loc: '1,3-6'},
    {code: 'ssss', loc: '3-6,8'},
    {code: 'dddd', loc: '8,3-6'},
    {code: 'hhcccsshc', loc: '4-6,1 4,2-4 5-6,4'},
  ],
  obstacles: [
    '0-9,3-6',
    '3-6,0-9'
  ],
  available_mappings: [],
  next_level: '1',
},
// 1
'1': {
  dims: {w: 9, h: 9},
  startpos: {x: 0, y: 4},
  exitpos: {x: 4, y: 7},
  obstacles: [ '2,0-9', '6,0-9' ],
  programs: [
    {loc: '2-6,3', code: 'dssss' },
  ],
  available_mappings: [],
  next_level: 'a',
}
};

var dwim = new Dwim(
  document.getElementById('level'),
  document.getElementById('status1'),
  document.getElementById('status2')
  );

level_id = window.location.search;
if (level_id !== '0' && !level_id) {
  level_id = '0';
} else {
  level_id = level_id.substr(1)
}

console.log('start level ' + level_id)

dwim.start(levels[level_id]);

</script>
</body>
</html>
