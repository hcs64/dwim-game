<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>dwim</title>

<script src="utils.js"></script>
<script src="graphics.js"></script>
<script src="dwim.js"></script>
<script src="levels.js"></script>

<style>
body {
  background-color: black;
  color: white;
}

a {
  color: blue;
}
a.fake-link {
  text-decoration: underline;
  cursor: pointer;
}

div#instructions {
  display: none;
}

div.inblock {
  display: inline-block;
}

</style>
</head>

<body>
<div>
<a id="instructions-link" class="fake-link"
   onclick="getElementById('instructions-link').style.display='none'; getElementById('instructions').style.display='block';">Instructions</a>
</div>
<div id="instructions">
Get to the star.<br>
Arrow keys to move.<br>
Number keys (1,2,3 ...) to switch modes.<br>
Mouse over a <span style="background-color: #404040;">program region</span> to view its code.<br>
You can reload this page to retry if you get stuck.
</div>

<div class="inblock" id="game1"></div>

<div class="inblock">spacer</div>

<div class="inblock" id="menu1">
<a class="fake-link" onclick="menu[1]()">1 1 1 1<br>1 1 1 1<br>1 1 1 1<br>1 1 1 1</a><br><br>
<a class="fake-link" onclick="menu[2]()">2 2 2 2<br>2 2 2 2<br>2 2 2 2<br>2 2 2 2</a><br><br>
<a class="fake-link" onclick="menu[3]()">3 3 3 3<br>3 3 3 3<br>3 3 3 3<br>3 3 3 3</a><br><br>
<a class="fake-link" onclick="menu[4]()">4 4 4 4<br>4 4 4 4<br>4 4 4 4<br>4 4 4 4</a><br><br>
</div>

<div class="inblock">spacer</div>

<div class="inblock" id="menu2">
<a class="fake-link" onclick="menu.up()">UP UP<br>UP UP<br>UP UP<br>UP UP</a><br><br>
<a class="fake-link" onclick="menu.down()">DOWN<br>DOWN<br>DOWN<br>DOWN</a><br><br>
<a class="fake-link" onclick="menu.left()">LEFT<br>LEFT<br>LEFT<br>LEFT</a><br><br>
<a class="fake-link" onclick="menu.right()">RIGHT<br>RIGHT<br>RIGHT<br>RIGHT</a><br><br>
</div>

<script>

menu = {
};

(function(){

levels = levelsFcn()

var level_id = window.location.search;
if (level_id !== '0' && !level_id) {
  level_id = '0';
} else {
  level_id = level_id.substr(1);
}

if (level_id === 'end') {
  var p = document.createElement('p');
  p.textContent = 'That\'s it, thank you for playing!';
  document.getElementById('game1').appendChild(p);
  document.getElementById('instructions-link').style.display='none';
} else {
  var game = new Dwim(
    document.getElementById('game1'),
    levels[level_id],
    level_id
  );

  menu[1] = function(){
    game.keyboardCB('1');
  };
  menu[2] = function(){
    game.keyboardCB('2');
  };
  menu[3] = function(){
    game.keyboardCB('3');
  };
  menu[4] = function(){
    game.keyboardCB('4');
  };
  menu.up = function(){
    game.keyboardCB('<up>');
  };
  menu.down = function(){
    game.keyboardCB('<down>');
  };
  menu.left = function(){
    game.keyboardCB('<left>');
  };
  menu.right = function(){
    game.keyboardCB('<right>');
  };

  game.startRender()
}

})();
</script>
</body>
</html>
